<h1>Transactions</h1>

<p><b>Add A New Transaction:</b></p>

<form action="/banked/transactions" method="POST">

  <label for="description">Description:</label>
  <input type="text" name="description" id="description"/>

  <label for="value">Value: £</label>
  <input type="number" step="0.01" name="value" id="value"/>

  <label for="spend_date">Date:</label>
  <input type="date" name="spend_date" id="spend_date" required/>

  <label for="merchant-select">Merchant:</label>
  <select name="merchant_id" id="merchant-select">
    <% for merchant in @merchants %>
      <option value="<%= merchant.id %>"><%= merchant.name %></option>
    <% end %>
  </select>

  <label for="tag-select">Tag:</label>
  <select name="tag_id" id="tag-select">
    <% for tag in @tags %>
      <option value="<%= tag.id %>"><%= tag.name %></option>
    <% end %>
  </select>

  <input type="submit" value="Add Transaction">

</form>

<p><b>Filter Transactions by Tag, Merchant, Date or Value:</b></p>

<form action="/banked/transactions/filter_tag" method="POST">

  <label for="tag-select"></label>
  <select name="id" id="tag-select">
    <% for tag in @tags %>
      <option value="<%= tag.id %>"><%= tag.name %></option>
    <% end %>
  </select>

  <input type="submit" value="Filter By Tag">

</form>

<form action="/banked/transactions/filter_merchant" method="POST">

  <label for="merchant-select"></label>
  <select name="id" id="merchant-select">
    <% for merchant in @merchants %>
      <option value="<%= merchant.id %>"><%= merchant.name %></option>
    <% end %>
  </select>

  <input type="submit" value="Filter By Merchant">

</form>

<form action="/banked/transactions/filter_date" method="POST">

  <label for="start_date">Start Date:</label>
  <input type="date" name="start_date" id="start_date" value="<%= @start_date %>" required/>

  <label for="end_date">End Date:</label>
  <input type="date" name="end_date" id="end_date" value="<%= @end_date %>" required/>

  <input type="submit" value="Filter By Date">

</form>

<form action="/banked/transactions/filter_value" method="POST">

  <label for="value-select"></label>
  <select name="operator" id="value-select">
      <option value="less">Less Than</option>
      <option value="greater">Greater Than</option>
  </select>

  <label for="value">Value: £</label>
  <input type="number" name="value" id="value" required/>

  <input type="submit" value="Filter By Value">

</form>

<a href="/banked/transactions">Reset Filter</a>

<p><b>Previous Transactions Filtered by Date = <%= @start_date_formatted %> to <%= @end_date_formatted %>:</b></p>

<% @transactions.each do |transaction| %>

  <p>------------------------------</p>
  <p>Transaction ID: <%= transaction.id %></p>
  <p>Description: <a href="/banked/transactions/<%= transaction.id %>"><%= transaction.description %></a></p>
  <p>Value: £<%= "%.2f" % transaction.value %></p>
  <p>Date: <%= transaction.spend_date %></p>
  <p>Merchant: <%= Merchant.find(transaction.merchant_id).name %></p>
  <p>Tag: <%= Tag.find(transaction.tag_id).name %></p>

<% end %>
